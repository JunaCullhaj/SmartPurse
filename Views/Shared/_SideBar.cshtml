@using Microsoft.AspNetCore.Identity
@using Expense_Tracker.Models
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@{
    List<Object> menuItems = new List<Object>();



    menuItems.Add(new { text = "General", separator = true });

    menuItems.Add(new { text = "Dashboard", url = "/", iconCss = "fa-solid fa-box" });

    menuItems.Add(new { text = "Categories", url = "/Category", iconCss = "fa-solid fa-folder-closed" });

    menuItems.Add(new { text = "Transactions", url = "/Transaction", iconCss = "fa-solid fa-arrow-right-arrow-left" });

    menuItems.Add(new { text = "Goals", url = "/Goals", iconCss = "fa-solid fa-chart-simple" });



    string profileName = "Click to create/login";

    string profileLink = "/Account/Register";



    if (SignInManager.IsSignedIn(User))

    {

        var user = await UserManager.GetUserAsync(User);

        if (user != null)

        {

            profileName = $"{user.FirstName} {user.LastName}";

            profileLink = "/Profile"; 

        }

    }
}

<ejs-sidebar id="sidebar" width="290px" enableDock dockSize="100px"
             target=".dock-target" enableGestures="false">
    <e-content-template>

        <div class="logo-wrapper">
            <div class="app-logo">
                <img src="~/logo.png" />
            </div>
            <div class="w-100"></div>
            <i id="sidebar-toggler" class="fa-solid"></i>
        </div>

        <a href="@profileLink" style="text-decoration: none;">
            <div class="profile-wrapper d-flex align-items-center gap-3 px-3 py-2" style="cursor: pointer; background-color: #2c2c3b; border-radius: 8px; margin: 10px;">
                <i class="fa-solid fa-user fa-lg text-light"></i>
                <div class="titles d-flex flex-column">
                    <span class="fw-bold text-light" style="font-size: 1rem;">Profile</span>
                    <small class="text-muted">@profileName</small>
                </div>
            </div>
        </a>

        <ejs-menu id="menu"
                  items="menuItems"
                  orientation="Vertical"
                  hamburgerMode></ejs-menu>

    </e-content-template>
</ejs-sidebar>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var dockBar = document.getElementById('sidebar').ej2_instances[0];
        document.getElementById('sidebar-toggler').onclick = function () {
            dockBar.toggle();
        };
    });
</script>
